<!DOCTYPE html>
<html onkeydown='startwork(event)'>
<head>
<title>Ebced Değeri Hesaplama Aracı</title>
<meta name="viewport" content="width=device-width" />
<meta content='http://ebced.kuran114.org/' property='og:url'/>
<meta content='Ebced Değeri Hesaplayıcı' property='og:title'/>
<meta content='Eş zamanlı Ebced/Sayı Değeri Hesaplayıcısı' property='og:description'/>
<link href='pic/favicon.ico' rel='icon' type='image/x-icon'/>
<style>
body {background-color: azure;}

#back {position: fixed; z-index: -1; opacity: 0.19; left: 50%; margin-left: -150.68px;}

#main {font-size: 14pt;}
#text {margin-left: 25%; font-size: 15pt;}

#book {padding-top: 38px;}

textarea {
	background-color: rgba(0, 255, 255, 0.38);
	border-radius: 2px;
	font-size: 14pt;
	direction: rtl;
	width: 50%;
	margin-left: 25%;
	background-image: url(pic/flower.png);
	background-repeat: no-repeat;
	background-size: contain;
	background-position: 50% 0%;
}

textarea:focus {
	background-image: url(pic/background.png);
	background-size: cover;
	background-color: #d4fff3;
}

#baslik {font-size: large; text-align: center;}


#kopyala {display: none; font-size: 14pt; padding: 4px 6px 4px 6px;}

@media only screen and (max-width: 768px) {
	th {font-size: 14pt;}
	#main {font-size: 15pt;}
	#text {font-size: 16pt;}
	#kopyala {font-size: 14pt; padding: 6px;}
	textarea {font-size: 14pt;}
}

@media only screen and (min-width: 425px) and (max-width: 768px) {
	textarea {font-size: 14pt; width: 80%; margin-left: 10%;}
	#text {margin-left: 10%;}	
}

@media only screen and (max-width: 425px) {
	textarea {font-size: 15pt; width: 90%; margin-left: 5%;}
	#text {margin-left: 5%;}
}
</style>
<link rel="stylesheet" type="text/css" href="css/sweetalert.min.css">
</head>

<body>
<p id="baslik">Ebced Değeri Hesaplama Aracı:</p>
	
<input id="sure" placeholder="sure no" size="3"></input>
<input id="ayet" placeholder="ayet no1-no2 || ayet no" size="15"></input>
<button id="buton" onclick="loadXMLDoc()">Ayet Metnini Getir</button>
<br>
<textarea placeholder="...Yazmaya başlayın" id="ifade" rows="6" cols="75"></textarea>
<br>
<div id="back"><img id="book" src="pic/book arabic.png"></img></div>
<div id="text">
	<div id="main">
		<p id="abjad"></p>
		<p id="letters"></p>
		<p id="words"></p>
		<button id="kopyala"> Sonuçları Kopyala </button>
	</div>
	<p id="ا"></p><p id="ب"></p><p id="ج"></p><p id="د"></p><p id="ه"></p><p id="و"></p><p id="ز"></p><p id="ح"></p>
	<p id="ط"></p><p id="ي"></p><p id="ك"></p><p id="ل"></p><p id="م"></p><p id="ن"></p><p id="س"></p><p id="ع"></p>
	<p id="ف"></p><p id="ص"></p><p id="ق"></p><p id="ر"></p><p id="ش"></p><p id="ت"></p><p id="ث"></p><p id="خ"></p>
	<p id="ذ"></p><p id="ض"></p><p id="ظ"></p><p id="غ"></p>
</div>

<script>
$('#sure').on('input', function (event) { 
    this.value = this.value.replace(/[^0-9]/igm, '');
});

$('#ayet').on('input', function (event) { 
    this.value = this.value.replace(/[^0-9-]/igm, '');
});

function loadXMLDoc() {
  var xmlhttp = new XMLHttpRequest();
  xmlhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      myFunction(this);
    }
  };
  var sure = document.getElementById("sure").value;
  if(sure){
  	xmlhttp.open("GET", "sure/" + sure + ".xml", true);
  	xmlhttp.send();
  }else{
  	alert("En azından sure numarasını girmelisin.");
  }
}

function myFunction(xml) {
  var ayet = document.getElementById("ayet").value;
  var dizi = ayet.split("-");
  var ayet1 = parseInt(dizi[0]) - 1;
  var ayet2 = parseInt(dizi[1]) - 1;

  var x, i, xmlDoc, txt;
  xmlDoc = xml.responseXML;
  txt = "";
  x = xmlDoc.getElementsByTagName("ARTIST");
      if(ayet){
  	      if (ayet2){
  	          for (i = ayet1; i < ayet2+1; i++) {
  	  	          txt += x[i].childNodes[0].nodeValue + "\n";
  	          }
          }else{
  	          txt = x[ayet1].childNodes[0].nodeValue;
          }
      }else{
  	      for (i = 0; i< x.length; i++) {
      	      txt += x[i].childNodes[0].nodeValue + "\n";
  	      }
      }
      document.getElementById("ifade").innerHTML = txt;
}
</script>

<script type="text/javascript" src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src='js/sweetalert.min.js'></script>
<script type="text/javascript">

function getSum(total,num){return total + num};

function val(yazı,harf,değer){
	rgxp = new RegExp(değer,'gim');
	var text = yazı.replace(/[0-9]/igm, "");
	if (text.indexOf(harf) > -1){
		sonuc = text.split(harf).join(değer).match(rgxp).map(Number).reduce(getSum)
	}else{
		sonuc = 0
	};
	return sonuc;
}

function letters(str) {
	var lamelif = str.match(/[ﻻﻹﻷﻵ]/igm);
	var other = str.match(/[ء-ي]/igm);
	if(other!==null && other.length!==0 && lamelif!==null && lamelif.length!==0){
		var others = parseInt(other.length);
		var lamelif_T = 2 * parseInt(lamelif.length);
		return others + lamelif_T
	}
	else if(lamelif!==null && lamelif.length!==0){
		var lamelif_T = 2 * parseInt(lamelif.length);
		return lamelif_T
	}
	else if(other!==null && other.length!==0){
		var others = parseInt(other.length);
		return others
	}
}
function words(string){
	y = string.split(/\s+/).filter(
		function(string){
			word = string.match(/[ء-يﻻﻹﻷﻵ]+/igm);
			return word && word[0].length > 0;
		}
	);
	return y.length;
}
function abjad (string) {
	ء = val(string,'ء','1');
	ا = val(string,'ا','1');
	آ = val(string,'آ','1');
	ٱ = val(string,'ٱ','1');
	أ = val(string,'أ','1');
	إ = val(string,'إ','1');
	ب = val(string,'ب','2');
	پ = val(string,'پ','2');
	ج = val(string,'ج','3');
	چ = val(string,'چ','3');
	د = val(string,'د','4');
	ه = val(string,'ه','5');
	ة = val(string,'ة','5');
	و = val(string,'و','6');
	ؤ = val(string,'ؤ','6');
	ز = val(string,'ز','7');
	ژ = val(string,'ژ','7');
	ح = val(string,'ح','8');
	ط = val(string,'ط','9');
	ی = val(string,'ی','10');
	ي = val(string,'ي','10');
	ئ = val(string,'ئ','10');
	ى = val(string,'ى','10');
	ک = val(string,'ک','20');
	ك = val(string,'ك','20');
	گ = val(string,'گ','20');
	ڭ = val(string,'ڭ','20');
	ل = val(string,'ل','30');
	م = val(string,'م','40');
	ن = val(string,'ن','50');
	س = val(string,'س','60');
	ع = val(string,'ع','70');
	ف = val(string,'ف','80');
	ڢ = val(string,'ڢ','80');
	ڤ = val(string,'ڤ','80');
	ص = val(string,'ص','90');
	ق = val(string,'ق','100');
	ڨ = val(string,'ڨ','100');
	ر = val(string,'ر','200');
	ش = val(string,'ش','300');
	ت = val(string,'ت','400');
	ث = val(string,'ث','500');
	خ = val(string,'خ','600');
	ذ = val(string,'ذ','700');
	ض = val(string,'ض','800');
	ظ = val(string,'ظ','900');
	غ = val(string,'غ','1000');
	ﻻ = val(string,'ﻻ','31');
	ﻹ = val(string,'ﻹ','31');
	ﻷ = val(string,'ﻷ','31');
	ﻵ = val(string,'ﻵ','31');
	return ء+ا+آ+ٱ+أ+إ+ب+پ+ج+چ+د+ه+ة+و+ؤ+ز+ژ+ح+ط+ی+ي+ئ+ى+ک+ك+گ+ڭ+ل+م+ن+س+ع+ف+ڢ+ڤ+ص+ق+ڨ+ر+ش+ت+ث+خ+ذ+ض+ظ+غ+ﻻ+ﻹ+ﻷ+ﻵ
}

function startwork(event){
	box = document.getElementById("ifade");
	sure = document.getElementById("sure");
	if(/\d/.test(box.value)){
		if ( sure === document.activeElement ){}else{
			sure.focus();
		}		
	}else{
		if ( box === document.activeElement ){}else{
			box.focus();
		}
	}
}

function copyToClipboard(text) {
	if (window.clipboardData && window.clipboardData.setData) {
		return clipboardData.setData("Text", text);
	}
	else if (document.queryCommandSupported && document.queryCommandSupported("copy")) {
		textarea = document.createElement("textarea");
  		textarea.textContent = text;
  		textarea.style.position = "fixed";
  		document.body.appendChild(textarea); textarea.select();
  		try {return document.execCommand("copy")}
  		catch (ex) {console.warn("Copy to clipboard failed.", ex); return false;}
		finally {document.body.removeChild(textarea)}
	}
}

$(window).load( function(){
	var hashParams = window.location.hash.substr(1).replace(/[_]+/gim, " ").replace(/[-]+/gim, "\n").split('&');
	for(var i = 0; i < hashParams.length; i++){
		var p = hashParams[i].split('=');
		document.getElementById(p[0]).value = decodeURIComponent(p[1]);
	}
	$('#ifade').keyup();
});

$('#ifade').on('input', function (event) { 
    this.value = this.value.replace(/[^ء-ي ﻻﻹﻷﻵ\n0-9:#]/igm, '');
});

$("#ifade").keyup( function(){
	var inputValue = $(this).val();
if( abjad(inputValue) ) {
	document.querySelector("#kopyala").style.display = "block";
	if (abjad(inputValue) % 19 === 0) {
		ebced = abjad(inputValue) + " = 19 × " + abjad(inputValue)/19;
		$("#abjad").html("<span style=\"color: blue;\">" + "EBCED değeri: " + ebced + "</span>");
	}else{
		ebced = abjad(inputValue);
		$("#abjad").html("EBCED değeri: " + ebced);
	}
	if (letters(inputValue) % 19 === 0) {
		harf = letters(inputValue) + " = 19 × " + letters(inputValue)/19;
		$("#letters").html("<span style=\"color: blue;\">" + "HARF sayısı: " + harf + "</span>");
	}else{
		harf = letters(inputValue);
		$("#letters").html("HARF sayısı: " + harf);
	}
	if (words(inputValue) % 19 === 0) {
		kelime = words(inputValue) + " = 19 × " + words(inputValue)/19;
		$("#words").html("<span style=\"color: blue;\">" + "KELİME sayısı: " + kelime + "</span>");
	}else{
		kelime = words(inputValue);
		$("#words").html("KELİME sayısı: " + kelime);
	}
	mesaj = "ebced.kuran114.org/#ifade=" +  inputValue.replace(/[ ]+/gim, "_").replace(/[\n]+/gim, "-") + "\n\n" + "EBCED değeri: " + ebced + "\n" + "HARF sayısı: " + harf + "\n" + "KELİME sayısı: " + kelime;
	
	function harf1(h1){
		if(ch == h1){
			sonuc = counts[h1]
			if(sonuc == 0) {
				return $("p[id=" + h1 + "]").html('')
			}else{
				if (sonuc % 19 === 0) {
					harf = sonuc + " = 19 × " + sonuc/19;
					return $("p[id=" + h1 + "]").html("<span style=\"color: blue;\">" + h1 + ' sayısı: ' + harf + "</span>");
				}else{
					harf = sonuc;
					return $("p[id=" + h1 + "]").html(h1 + ' sayısı: ' + sonuc);
				}
			}
		}
	}
  
	function harf2(h1, h2){
		if(ch == h1 || ch == h2){
			sonuc = counts[h1] + counts[h2]
			if(sonuc == 0) {
				return $("p[id=" + h1 + "]").html('')
			}else{
				if (sonuc % 19 === 0) {
					harf = sonuc + " = 19 × " + sonuc/19;
					return $("p[id=" + h1 + "]").html("<span style=\"color: blue;\">" + h1 + ' sayısı: ' + harf + "</span>");
				}else{
					harf = sonuc;
					return $("p[id=" + h1 + "]").html(h1 + ' sayısı: ' + sonuc);
				}
			}
		}
	}

	function harf3(h1, h2, h3){
		if(ch == h1 || ch == h2 || ch == h3){
			sonuc = counts[h1] + counts[h2] + counts[h3]
			if(sonuc == 0) {
				return $("p[id=" + h1 + "]").html('')
			}else{
				if (sonuc % 19 === 0) {
					harf = sonuc + " = 19 × " + sonuc/19;
					return $("p[id=" + h1 + "]").html("<span style=\"color: blue;\">" + h1 + ' sayısı: ' + harf + "</span>");
				}else{
					harf = sonuc;
					return $("p[id=" + h1 + "]").html(h1 + ' sayısı: ' + sonuc);
				}
			}
		}
	}

	function harf4(h1, h2, h3, h4){
		if(ch == h1 || ch == h2 || ch == h3 || ch == h4){
			sonuc = counts[h1] + counts[h2] + counts[h3] + counts[h4]
			if(sonuc == 0) {
				return $("p[id=" + h1 + "]").html('')
			}else{
				if (sonuc % 19 === 0) {
					harf = sonuc + " = 19 × " + sonuc/19;
					return $("p[id=" + h1 + "]").html("<span style=\"color: blue;\">" + h1 + ' sayısı: ' + harf + "</span>");
				}else{
					harf = sonuc;
					return $("p[id=" + h1 + "]").html(h1 + ' sayısı: ' + sonuc);
				}
			}
		}
	}
  
	function harf5(h1, h2, h3, h4, h5){
		if(ch == h1 || ch == h2 || ch == h3 || ch == h4 || ch == h5){
			sonuc = counts[h1] + counts[h2] + counts[h3] + counts[h4] + counts[h5]
			if(sonuc == 0) {
				return $("p[id=" + h1 + "]").html('')
			}else{
				if (sonuc % 19 === 0) {
					harf = sonuc + " = 19 × " + sonuc/19;
					return $("p[id=" + h1 + "]").html("<span style=\"color: blue;\">" + h1 + ' sayısı: ' + harf + "</span>");
				}else{
					harf = sonuc;
					return $("p[id=" + h1 + "]").html(h1 + ' sayısı: ' + sonuc);
				}
			}
		}
	}
	
	function harf10(h1, h2, h3, h4, h5, h6, h7, h8, h9, h10){
	if(ch == h1 || ch == h2 || ch == h3 || ch == h4 || ch == h5 || ch == h6 || ch == h7 || ch == h8 || ch == h9 || ch == h10){
		sonuc = counts[h1]+counts[h2]+counts[h3]+counts[h4]+counts[h5]+counts[h6]+counts[h7]+counts[h8]+counts[h9]+counts[h10]
		if(sonuc == 0) {
			return $("p[id=" + h1 + "]").html('')
		}else{
			if (sonuc % 19 === 0) {
				harf = sonuc + " = 19 × " + sonuc/19;
				return $("p[id=" + h1 + "]").html("<span style=\"color: blue;\">" + h1 + ' sayısı: ' + harf + "</span>");
			}else{
				harf = sonuc;
				return $("p[id=" + h1 + "]").html(h1 + ' sayısı: ' + sonuc);
			}
		}
	}
	}
	
	var counts = {ء:0,ا:0,آ:0,ٱ:0,أ:0,إ:0,ب:0,پ:0,ج:0,چ:0,د:0,ه:0,ة:0,و:0,ؤ:0,ز:0,ژ:0,ح:0,ط:0,ی:0,ي:0,ئ:0,ى:0,ک:0,ك:0,گ:0,ڭ:0,ل:0,م:0,ن:0,س:0,ع:0,ف:0,ڢ:0,ڤ:0,ص:0,ق:0,ڨ:0,ر:0,ش:0,ت:0,ث:0,خ:0,ذ:0,ض:0,ظ:0,غ:0,ﻻ:0,ﻹ:0,ﻷ:0,ﻵ:0};
	var ch, index, len, count;
	for (index = 0, len = inputValue.length; index < len; ++index) {
		ch = inputValue.charAt(index);
		count = counts[ch];
		counts[ch] = count ? count + 1 : 1;
	}
	for (ch in counts) {
		harf1('د');
		harf1('ح');
		harf1('ط');
		harf1('م');
		harf1('ن');
		harf1('س');
		harf1('ع');
		harf1('ص');
		harf1('ر');
		harf1('ش');
		harf1('ت');
		harf1('ث');
		harf1('خ');
		harf1('ذ');
		harf1('ض');
		harf1('ظ');
		harf1('غ');
		harf2('ب','پ');
		harf2('ج','چ');
		harf2('ه','ة');
		harf2('و','ؤ');
		harf2('ز','ژ');
		harf2('ق','ڨ');
		harf3('ف','ڢ','ڤ');
		harf4('ي','ی','ئ','ى');
		harf4('ك','ک','گ','ڭ');
		harf5('ل','ﻻ','ﻹ','ﻷ','ﻵ');
		harf10('ا','ﻻ','ﻹ','ﻷ','ﻵ','ء','آ','ٱ','أ','إ');
	}
	
	if (counts.hasOwnProperty('ا')) {}else{ $("p[id=ا]").html("") }
	if (counts.hasOwnProperty('ب')) {}else{ $("p[id=ب]").html("") }
	if (counts.hasOwnProperty('ج')) {}else{ $("p[id=ج]").html("") }
	if (counts.hasOwnProperty('د')) {}else{ $("p[id=د]").html("") }
	if (counts.hasOwnProperty('ه')) {}else{ $("p[id=ه]").html("") }
	if (counts.hasOwnProperty('و')) {}else{ $("p[id=و]").html("") }
	if (counts.hasOwnProperty('ز')) {}else{ $("p[id=ز]").html("") }
	if (counts.hasOwnProperty('ح')) {}else{ $("p[id=ح]").html("") }
	if (counts.hasOwnProperty('ط')) {}else{ $("p[id=ط]").html("") }
	if (counts.hasOwnProperty('ي')) {}else{ $("p[id=ي]").html("") }
	if (counts.hasOwnProperty('ك')) {}else{ $("p[id=ك]").html("") }
	if (counts.hasOwnProperty('ل')) {}else{ $("p[id=ل]").html("") }
	if (counts.hasOwnProperty('م')) {}else{ $("p[id=م]").html("") }
	if (counts.hasOwnProperty('ن')) {}else{ $("p[id=ن]").html("") }
	if (counts.hasOwnProperty('س')) {}else{ $("p[id=س]").html("") }
	if (counts.hasOwnProperty('ع')) {}else{ $("p[id=ع]").html("") }
	if (counts.hasOwnProperty('ف')) {}else{ $("p[id=ف]").html("") }
	if (counts.hasOwnProperty('ص')) {}else{ $("p[id=ص]").html("") }
	if (counts.hasOwnProperty('ق')) {}else{ $("p[id=ق]").html("") }
	if (counts.hasOwnProperty('ر')) {}else{ $("p[id=ر]").html("") }
	if (counts.hasOwnProperty('ش')) {}else{ $("p[id=ش]").html("") }
	if (counts.hasOwnProperty('ت')) {}else{ $("p[id=ت]").html("") }
	if (counts.hasOwnProperty('ث')) {}else{ $("p[id=ث]").html("") }
	if (counts.hasOwnProperty('خ')) {}else{ $("p[id=خ]").html("") }
	if (counts.hasOwnProperty('ذ')) {}else{ $("p[id=ذ]").html("") }
	if (counts.hasOwnProperty('ض')) {}else{ $("p[id=ض]").html("") }
	if (counts.hasOwnProperty('ظ')) {}else{ $("p[id=ظ]").html("") }
	if (counts.hasOwnProperty('غ')) {}else{ $("p[id=غ]").html("") }	
}else{
	$("#abjad").html("");
	$("#letters").html("");
	$("#words").html("");
	mesaj = "";
	document.querySelector("#kopyala").style.display = "none";
	$("#ا").html("");
	$("#ب").html("");
	$("#ج").html("");
	$("#د").html("");
	$("#ه").html("");
	$("#و").html("");
	$("#ز").html("");
	$("#ح").html("");
	$("#ط").html("");
	$("#ي").html("");
	$("#ك").html("");
	$("#ل").html("");
	$("#م").html("");
	$("#ن").html("");
	$("#س").html("");
	$("#ع").html("");
	$("#ف").html("");
	$("#ص").html("");
	$("#ق").html("");
	$("#ر").html("");
	$("#ش").html("");
	$("#ت").html("");
	$("#ث").html("");
	$("#خ").html("");
	$("#ذ").html("");
	$("#ض").html("");
	$("#ظ").html("");
	$("#غ").html("");
};
	document.querySelector("#kopyala").onclick = function() {
		var result = copyToClipboard(mesaj);
		console.log("copied?", result);
		swal({title: "Sonuçlar Kopyalandı!", text: "sorguladınmı.com - kuran114.org", timer: 1450, imageUrl: "pic/abjad.png", showConfirmButton: false});
	};
});

</script>
</body>
</html>
